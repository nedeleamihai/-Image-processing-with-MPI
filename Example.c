#include <mpi.h>#include <stdio.h>#include <stdlib.h>#include <string.h>#include <pthread.h>#include <math.h>#include <time.h>#define N 6int main(int argc, char **argv) {		int a[N][N], i, j, p, tag = 1336;	for(i = 0; i < N; i++){			for(j = 0; j < N; j++){				a[i][j] = i * 10 + j;			}		}    	int size, rank;    	MPI_Init(&argc, &argv);   	MPI_Comm_size(MPI_COMM_WORLD, &size);    	MPI_Comm_rank(MPI_COMM_WORLD, &rank);    	    	    	int NrTotalLinii = N - 2;    	int NrTotalProcese = size - 1;    	int nrLinii;    	int LiniiProcese[size];    	LiniiProcese[0] = 0;    	for(p = 1; p < size; p++){    		nrLinii = ceil((float)NrTotalLinii / NrTotalProcese);    		LiniiProcese[p] = nrLinii;    		NrTotalLinii -= nrLinii;    		NrTotalProcese--;    	}		if(rank == 0){				//MPI_Send( &a[1][1], nrLinii * (N - 2), MPI_INT, 1, tag-1, MPI_COMM_WORLD);		//MPI_Send( &a[2][1], nrLinii * (N - 2), MPI_INT, 2, tag-1, MPI_COMM_WORLD);		//MPI_Send( &a[3][1], nrLinii * (N - 2), MPI_INT, 3, tag-1, MPI_COMM_WORLD);		//MPI_Send( &a[4][1], nrLinii * (N - 2), MPI_INT, 4, tag-1, MPI_COMM_WORLD);				int lp = 0;		for(p = 1; p < size; p++){			int b[LiniiProcese[p] + 2][N];			lp += LiniiProcese[p - 1];								for(i = 0; i < LiniiProcese[p] + 2; i++){				for(j = 0; j < N; j++){					b[i][j] = a[lp + i][j];				}			}			MPI_Send(&b, (LiniiProcese[p] + 2) * N, MPI_INT, p, tag-1, MPI_COMM_WORLD);		}			}else{		int b[LiniiProcese[rank] + 2][N];		MPI_Recv( &b[0][0], (LiniiProcese[rank] + 2) * N, MPI_INT, 0, MPI_ANY_TAG, MPI_COMM_WORLD, MPI_STATUS_IGNORE );   	   		//printf("Processor %d has data: \n", rank);   		for(i = 1; i < LiniiProcese[rank] + 1; i++){			for(j = 1; j < N - 1; j++){										b[i][j] = rank;				//printf("%d ", b[i][j]);				}			//printf("\n");			//MPI_Send(&b[i][0], N, MPI_INT, 0, tag-1, MPI_COMM_WORLD);		}		//printf("\n");		MPI_Send(&b[0][0], (LiniiProcese[rank] + 2) * N, MPI_INT, 0, tag-1, MPI_COMM_WORLD);	}		if(rank == 0){				int lp = 0;		for(p = 1; p < size; p++){			int b[LiniiProcese[p] + 2][N];			lp += LiniiProcese[p - 1];						MPI_Recv( &b[0][0], (LiniiProcese[p] + 2) * N, MPI_INT, p, MPI_ANY_TAG, MPI_COMM_WORLD, MPI_STATUS_IGNORE );						for(i = 1; i < LiniiProcese[p] + 1; i++){				//MPI_Recv( &b[i][0], N, MPI_INT, p, MPI_ANY_TAG, MPI_COMM_WORLD, MPI_STATUS_IGNORE );				for(j = 0; j < N; j++){					a[lp + i][j] = b[i][j];				}			}		}				int d[N][N];		memcpy(d, a, N * N * sizeof(int));		printf("0: Processor %d has data: \n", rank);		for(i = 0; i < N; i++){			for(j = 0; j < N; j++){				printf("%d ", d[i][j]);			}			printf("\n");		}		printf("\n");	}	MPI_Finalize();}